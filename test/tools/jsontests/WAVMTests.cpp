#include "DPwTestsHelper.h"
#include <boost/range/algorithm/find.hpp>
using namespace std;
using namespace dev;
using namespace dev::eth;
using namespace dev::test;

namespace dev {
	namespace test {

		Address newAddress(const Account& account)
		{
			return right160(sha3(rlpList(Address(account.address), u256(account.nonce))));
		}


		string code1 = "0061736d01000000011d0660037f7f7f0060027f7f017f60017f0060027f7f0060000060017e0002a2010b03656e760a5741564d417373657274000303656e76086469765f75323536000003656e760765715f75323536000103656e760767745f75323536000103656e76076c745f75323536000103656e76086d6f645f75323536000003656e76086d756c5f75323536000003656e760b726561644d657373616765000103656e76087375625f75323536000003656e76057465737431000203656e760574657374320003030d0c000000000001010102020405040401700000050301000107d3010d066d656d6f727902000f5f5a706c524b35435432353653315f000b0f5f5a6d69524b35435432353653315f000c0f5f5a6d6c524b35435432353653315f000d0f5f5a6476524b35435432353653315f000e0f5f5a726d524b35435432353653315f000f0f5f5a6c74524b35435432353653315f00100f5f5a6774524b35435432353653315f00110f5f5a6571524b35435432353653315f0012125f5a3966756e6374696f6e313550617261310013125f5a3966756e6374696f6e32355061726132001404696e69740015056170706c7900160ab2040c0a0020012002200010080b0a0020012002200010080b0a0020012002200010060b0a0020012002200010010b0a0020012002200010050b0b002000200110044100470b0b002000200110034100470b0b002000200110024100470b0600200010090b0e0020002802002000280204100a0b0700418a3410090bb60303027f047e017f4100410028020441106b220736020442002104423b2103411021024200210503400240024002400240024020044209560d0020022c00002201419f7f6a41ff017141194b0d01200141a0016a21010c020b420021062004420b580d020c030b200141ea016a41002001414f6a41ff01714105491b21010b2001ad42388642388721060b2006421f83200342ffffffff0f838621060b200241016a2102200442017c2104200620058421052003427b7c2203427a520d000b024020052000520d00200741086a4104100741034b41201000200728020810090b42002104423b210341c00021024200210503400240024002400240024020044209560d0020022c00002201419f7f6a41ff017141194b0d01200141a0016a21010c020b420021062004420b580d020c030b200141ea016a41002001414f6a41ff01714105491b21010b2001ad42388642388721060b2006421f83200342ffffffff0f838621060b200241016a2102200442017c2104200620058421052003427b7c2203427a520d000b024020052000520d0020074108100741074b4120100020072802002007280204100a0b4100200741106a3602040b0b4e040041040b04504000000041100b0b746573745f66756e6331000041200b1e6d6573736167652073686f72746572207468616e206578706563746564000041c0000b0b746573745f66756e633200";
		string code2 = "0061736d01000000011d0660037f7f7f0060027f7f017f60017f0060027f7f0060000060017e0002a2010b03656e760a5741564d417373657274000303656e76086469765f75323536000003656e760765715f75323536000103656e760767745f75323536000103656e76076c745f75323536000103656e76086d6f645f75323536000003656e76086d756c5f75323536000003656e760b726561644d657373616765000103656e76087375625f75323536000003656e76057465737431000203656e760574657374320003030d0c000000000001010102020405040401700000050301000107d3010d066d656d6f727902000f5f5a706c524b35435432353653315f000b0f5f5a6d69524b35435432353653315f000c0f5f5a6d6c524b35435432353653315f000d0f5f5a6476524b35435432353653315f000e0f5f5a726d524b35435432353653315f000f0f5f5a6c74524b35435432353653315f00100f5f5a6774524b35435432353653315f00110f5f5a6571524b35435432353653315f0012125f5a3966756e6374696f6e313550617261310013125f5a3966756e6374696f6e32355061726132001404696e69740015056170706c7900160a84060c0a0020012002200010080b0a0020012002200010080b0a0020012002200010060b0a0020012002200010010b0a0020012002200010050b0b002000200110044100470b0b002000200110034100470b0b002000200110024100470b0600200010090b0e0020002802002000280204100a0b0700418a3410090b880503027f047e017f4100410028020441206b220736020442002104423b2103411021024200210503400240024002400240024020044209560d0020022c00002201419f7f6a41ff017141194b0d01200141a0016a21010c020b420021062004420b580d020c030b200141ea016a41002001414f6a41ff01714105491b21010b2001ad42388642388721060b2006421f83200342ffffffff0f838621060b200241016a2102200442017c2104200620058421052003427b7c2203427a520d000b024020052000520d00200741186a4104100741034b41201000200728021810090b42002104423b210341c00021024200210503400240024002400240024020044209560d0020022c00002201419f7f6a41ff017141194b0d01200141a0016a21010c020b420021062004420b580d020c030b200141ea016a41002001414f6a41ff01714105491b21010b2001ad42388642388721060b2006421f83200342ffffffff0f838621060b200241016a2102200442017c2104200620058421052003427b7c2203427a520d000b024020052000520d00200741106a4108100741074b4120100020072802102007280214100a0b42002104423b210341d00021024200210503400240024002400240024020044209560d0020022c00002201419f7f6a41ff017141194b0d01200141a0016a21010c020b420021062004420b580d020c030b200141ea016a41002001414f6a41ff01714105491b21010b2001ad42388642388721060b2006421f83200342ffffffff0f838621060b200241016a2102200442017c2104200620058421052003427b7c2203427a520d000b024020052000520d00200741086a4108100741074b412010002007280208200728020c100a0b4100200741206a3602040b0b5f050041040b04604000000041100b0b746573745f66756e6331000041200b1e6d6573736167652073686f72746572207468616e206578706563746564000041c0000b0b746573745f66756e6332000041d0000b0b746573745f66756e633300";
		string code_initIO = "0061736d01000000011d0660037f7f7f0060027f7f017f60017f0060027f7f0060000060017e0002a1010b03656e76086469765f75323536000003656e760765715f75323536000103656e760767745f75323536000103656e76076c745f75323536000103656e76086d6f645f75323536000003656e76086d756c5f75323536000003656e760873657473746f7265000303656e760c7365747532353676616c7565000303656e76087375625f75323536000003656e76057465737431000203656e760574657374320003030d0c000000000001010102020405040401700000050301000107d3010d066d656d6f727902000f5f5a706c524b35435432353653315f000b0f5f5a6d69524b35435432353653315f000c0f5f5a6d6c524b35435432353653315f000d0f5f5a6476524b35435432353653315f000e0f5f5a726d524b35435432353653315f000f0f5f5a6c74524b35435432353653315f00100f5f5a6774524b35435432353653315f00110f5f5a6571524b35435432353653315f0012125f5a3966756e6374696f6e313550617261310013125f5a3966756e6374696f6e32355061726132001404696e69740015056170706c7900160ab2010c0a0020012002200010080b0a0020012002200010080b0a0020012002200010050b0a0020012002200010000b0a0020012002200010040b0b002000200110034100470b0b002000200110024100470b0b002000200110014100470b0600200010090b0e0020002802002000280204100a0b3c01017f4100410028020441d0006b2200360204418a341009200041286a41101007200041201007200041286a200010064100200041d0006a3602040b02000b0b18030041040b04304000000041100b0236000041200b023700";
		string code_initIO_while = "0061736d01000000011d0660037f7f7f0060027f7f017f60017f0060027f7f0060000060017e0002a1010b03656e76086469765f75323536000003656e760765715f75323536000103656e760767745f75323536000103656e76076c745f75323536000103656e76086d6f645f75323536000003656e76086d756c5f75323536000003656e760873657473746f7265000303656e760c7365747532353676616c7565000303656e76087375625f75323536000003656e76057465737431000203656e760574657374320003030d0c000000000001010102020405040401700000050301000107d3010d066d656d6f727902000f5f5a706c524b35435432353653315f000b0f5f5a6d69524b35435432353653315f000c0f5f5a6d6c524b35435432353653315f000d0f5f5a6476524b35435432353653315f000e0f5f5a726d524b35435432353653315f000f0f5f5a6c74524b35435432353653315f00100f5f5a6774524b35435432353653315f00110f5f5a6571524b35435432353653315f0012125f5a3966756e6374696f6e313550617261310013125f5a3966756e6374696f6e32355061726132001404696e69740015056170706c7900160aac010c0a0020012002200010080b0a0020012002200010080b0a0020012002200010050b0a0020012002200010000b0a0020012002200010040b0b002000200110034100470b0b002000200110024100470b0b002000200110014100470b0600200010090b0e0020002802002000280204100a0b3601017f4100410028020441d0006b2200360204418a341009200041286a411010072000412010070340200041286a200010060c000b0b02000b0b18030041040b04304000000041100b0236000041200b023700";
		string no_init = "0061736d01000000011a0560037f7f7f0060027f7f017f60017f0060027f7f0060017e0002a2010b03656e760a5741564d417373657274000303656e76086469765f75323536000003656e760765715f75323536000103656e760767745f75323536000103656e76076c745f75323536000103656e76086d6f645f75323536000003656e76086d756c5f75323536000003656e760b726561644d657373616765000103656e76087375625f75323536000003656e76057465737431000203656e760574657374320003030c0b0000000000010101020204040401700000050301000107cc010c066d656d6f727902000f5f5a706c524b35435432353653315f000b0f5f5a6d69524b35435432353653315f000c0f5f5a6d6c524b35435432353653315f000d0f5f5a6476524b35435432353653315f000e0f5f5a726d524b35435432353653315f000f0f5f5a6c74524b35435432353653315f00100f5f5a6774524b35435432353653315f00110f5f5a6571524b35435432353653315f0012125f5a3966756e6374696f6e313550617261310013125f5a3966756e6374696f6e323550617261320014056170706c7900150aaa040b0a0020012002200010080b0a0020012002200010080b0a0020012002200010060b0a0020012002200010010b0a0020012002200010050b0b002000200110044100470b0b002000200110034100470b0b002000200110024100470b0600200010090b0e0020002802002000280204100a0bb60303027f047e017f4100410028020441106b220736020442002104423b2103411021024200210503400240024002400240024020044209560d0020022c00002201419f7f6a41ff017141194b0d01200141a0016a21010c020b420021062004420b580d020c030b200141ea016a41002001414f6a41ff01714105491b21010b2001ad42388642388721060b2006421f83200342ffffffff0f838621060b200241016a2102200442017c2104200620058421052003427b7c2203427a520d000b024020052000520d00200741086a4104100741034b41201000200728020810090b42002104423b210341c00021024200210503400240024002400240024020044209560d0020022c00002201419f7f6a41ff017141194b0d01200141a0016a21010c020b420021062004420b580d020c030b200141ea016a41002001414f6a41ff01714105491b21010b2001ad42388642388721060b2006421f83200342ffffffff0f838621060b200241016a2102200442017c2104200620058421052003427b7c2203427a520d000b024020052000520d0020074108100741074b4120100020072802002007280204100a0b4100200741106a3602040b0b4e040041040b04504000000041100b0b746573745f66756e6331000041200b1e6d6573736167652073686f72746572207468616e206578706563746564000041c0000b0b746573745f66756e633200";
		string div_0_u256 = "0061736d0100000001130460037f7f7f0060027f7f0060000060017e0002230203656e76086469765f75323536000003656e760c7365747532353676616c756500010304030002030404017000000503010001072b04066d656d6f727902000f5f5a6476524b35435432353653315f000204696e69740003056170706c7900040a54030a0020012002200010000b02000b4401017f410041002802044180016b2201360204200141d8006a41101001200141306a41201001200141d8006a200141306a200141086a1000410020014180016a3602040b0b1c030041040b04304000000041100b063131313131000041200b023000";
		string div_0_i32 = "0061736d01000000010e0360037f7f7f0060000060017e0002100103656e76086469765f7532353600000304030001020404017000000503010001072b04066d656d6f727902000f5f5a6476524b35435432353653315f000104696e69740002056170706c7900030a6a033601017f4100410028020441106b22033602042003200136020c20032002360208200328020c2002200010004100200341106a3602040b02000b2e01017f410028020441206b2201200037031820014101360214200141003602102001200128021441006d36020c0b0b0a010041040b0410400000";
		string invalid_u256_print = "0061736d0100000001150460037f7f7f0060027f7f017f60017f0060017e000286010903656e76086164645f75323536000003656e76086469765f75323536000003656e760765715f75323536000103656e760767745f75323536000103656e76076c745f75323536000103656e76086d6f645f75323536000003656e76086d756c5f75323536000003656e76097072696e7475323536000203656e76087375625f753235360000030a09000000000001010103040401700000050301000107a2010a066d656d6f727902000f5f5a706c524b35435432353653315f00090f5f5a6d69524b35435432353653315f000a0f5f5a6d6c524b35435432353653315f000b0f5f5a6476524b35435432353653315f000c0f5f5a726d524b35435432353653315f000d0f5f5a6c74524b35435432353653315f000e0f5f5a6774524b35435432353653315f000f0f5f5a6571524b35435432353653315f0010056170706c7900110a8101090a0020012002200010000b0a0020012002200010080b0a0020012002200010060b0a0020012002200010010b0a0020012002200010050b0b002000200110044100470b0b002000200110034100470b0b002000200110024100470b2401017f4100410028020441306b2201360204200141086a10074100200141306a3602040b0b0a010041040b0410400000";
		string unknowInstruction = "0061736d0100000001080260000060017e00020c0103656e760461646432000003030200010404017000000503010001071903066d656d6f7279020004696e69740001056170706c7900020a090202000b040010000b0b0a010041040b0410400000";
		string memoryRef = "0061736d01000000011a0560037f7f7f0060027f7f017f60027f7f0060017f0060017e000299010a03656e76086164645f75323536000003656e76086469765f75323536000003656e760765715f75323536000103656e760767745f75323536000103656e76076c745f75323536000103656e76086d6f645f75323536000003656e76086d756c5f75323536000003656e76097072696e7475323536000303656e760c7365747532353676616c7565000203656e76087375625f753235360000030a09000000000001010104040401700000050301000107a2010a066d656d6f727902000f5f5a706c524b35435432353653315f000a0f5f5a6d69524b35435432353653315f000b0f5f5a6d6c524b35435432353653315f000c0f5f5a6476524b35435432353653315f000d0f5f5a726d524b35435432353653315f000e0f5f5a6c74524b35435432353653315f000f0f5f5a6774524b35435432353653315f00100f5f5a6571524b35435432353653315f0011056170706c7900120aa101090a0020012002200010000b0a0020012002200010090b0a0020012002200010060b0a0020012002200010010b0a0020012002200010050b0b002000200110044100470b0b002000200110034100470b0b002000200110024100470b4401037f4100410028020441d0006b2203360204200341286a4180964f6a22014110100820034180964f6a22024120100820011007200210074100200341d0006a3602040b0b18030041040b04304000000041100b0236000041200b023700";
		//string transferBalance = "0061736d01000000011d0660037f7f7f0060027f7f017f60027f7f0060017f0060000060017e0002af010b03656e76086164645f75323536000003656e76086469765f75323536000003656e760765715f75323536000103656e760767745f75323536000103656e76076c745f75323536000103656e76086d6f645f75323536000003656e76086d756c5f75323536000003656e76097072696e7475323536000303656e760c7365747532353676616c7565000203656e76087375625f75323536000003656e760f7472616e7366657262616c616e63650002030b0a00000000000101010405040401700000050301000107a9010b066d656d6f727902000f5f5a706c524b35435432353653315f000b0f5f5a6d69524b35435432353653315f000c0f5f5a6d6c524b35435432353653315f000d0f5f5a6476524b35435432353653315f000e0f5f5a726d524b35435432353653315f000f0f5f5a6c74524b35435432353653315f00100f5f5a6774524b35435432353653315f00110f5f5a6571524b35435432353653315f001204696e69740013056170706c7900140aa9040a0a0020012002200010000b0a0020012002200010090b0a0020012002200010060b0a0020012002200010010b0a0020012002200010050b0b002000200110044100470b0b002000200110034100470b0b002000200110024100470b02000bc80303027f047e017f4100410028020441d0006b220736020442002104423b2103411021024200210503400240024002400240024020044209560d0020022c00002201419f7f6a41ff017141194b0d01200141a0016a21010c020b420021062004420b580d020c030b200141ea016a41002001414f6a41ff01714105491b21010b2001ad42388642388721060b2006421f83200342ffffffff0f838621060b200241016a2102200442017c2104200620058421052003427b7c2203427a520d000b024020052000520d00200741286a41201008200741301008200741286a1007200741286a2007100a0b42002104423b210341c00021024200210503400240024002400240024020044209560d0020022c00002201419f7f6a41ff017141194b0d01200141a0016a21010c020b420021062004420b580d020c030b200141ea016a41002001414f6a41ff01714105491b21010b2001ad42388642388721060b2006421f83200342ffffffff0f838621060b200241016a2102200442017c2104200620058421052003427b7c2203427a520d000b024020052000520d00200741286a41d000100820074180011008200741286a1007200741286a2007100a0b4100200741d0006a3602040b0b78070041040b04904000000041100b0b746573745f66756e6331000041200b063131313131000041300b04313233000041c0000b0b746573745f66756e6332000041d0000b296363633635646231646539626666613165663739336435366464333238313237633337343738623300004180010b0434353600";
		string transferBalance
			= "0061736d01000000011d0660037f7f7f0060027f7f017f60017f0060027f7f0060000060017e0002f0010f03656e76086164645f75323536000003656e76086469765f75323536000003656e760765715f75323536000103656e760767745f75323536000103656e76076c745f75323536000103656e76086d6f645f75323536000003656e76086d756c5f75323536000003656e760c7072696e7461646472657373000203656e76067072696e7473000203656e76097072696e7475323536000203656e760f7365746164647265737376616c7565000303656e760c7365747532353676616c7565000303656e760473686133000003656e76087375625f75323536000003656e760f7472616e7366657262616c616e63650003030b0a00000000000101010405040401700000050301000107a9010b066d656d6f727902000f5f5a706c524b35435432353653315f000f0f5f5a6d69524b35435432353653315f00100f5f5a6d6c524b35435432353653315f00110f5f5a6476524b35435432353653315f00120f5f5a726d524b35435432353653315f00130f5f5a6c74524b35435432353653315f00140f5f5a6774524b35435432353653315f00150f5f5a6571524b35435432353653315f001604696e69740017056170706c7900180a94050a0a0020012002200010000b0a00200120022000100d0b0a0020012002200010060b0a0020012002200010010b0a0020012002200010050b0b002000200110044100470b0b002000200110034100470b0b002000200110024100470b5001017f4100410028020441c0006b22003602044110100841304105200041206a100c200041206a100941c00010082000100920004180b0f97c6a41e000100b41f00010084100200041c0006a3602040be50303027f047e017f4100410028020441c0006b220736020442002104423b210341900121024200210503400240024002400240024020044209560d0020022c00002201419f7f6a41ff017141194b0d01200141a0016a21010c020b420021062004420b580d020c030b200141ea016a41002001414f6a41ff01714105491b21010b2001ad42388642388721060b2006421f83200342ffffffff0f838621060b200241016a2102200442017c2104200620058421052003427b7c2203427a520d000b024020052000520d00200741286a41a001100a200741086a41d001100b200741286a1007200741086a1009200741286a200741086a100e0b42002104423b210341e00121024200210503400240024002400240024020044209560d0020022c00002201419f7f6a41ff017141194b0d01200141a0016a21010c020b420021062004420b580d020c030b200141ea016a41002001414f6a41ff01714105491b21010b2001ad42388642388721060b2006421f83200342ffffffff0f838621060b200241016a2102200442017c2104200620058421052003427b7c2203427a520d000b024020052000520d00200741286a41f001100a200741086a41a002100b200741286a1007200741086a1009200741286a200741086a100e0b4100200741c0006a3602040b0bfe010c0041040b04304100000041100b143d3d3d3d496e697420426567696e3d3d3d3d3d000041300b0668656c6c6f000041c0000b13696e76616c69642075323536207374617274000041e0000b0236000041f0000b11696e76616c6964207532353620656e6400004190010b0b746573745f66756e6331000041a0010b2b307830303030303030303030303030303030303030303030303030303030303030303030303131313131000041d0010b04313233000041e0010b0b746573745f66756e6332000041f0010b2b307863636336356462316465396266666131656637393364353664643332383132376333373437386233000041a0020b0434353600009404046e616d6501ba021900086164645f7532353601086469765f75323536020765715f75323536030767745f7532353604076c745f7532353605086d6f645f7532353606086d756c5f75323536070c7072696e746164647265737308067072696e747309097072696e74753235360a0f7365746164647265737376616c75650b0c7365747532353676616c75650c04736861330d087375625f753235360e0f7472616e7366657262616c616e63650f0f5f5a706c524b35435432353653315f100f5f5a6d69524b35435432353653315f110f5f5a6d6c524b35435432353653315f120f5f5a6476524b35435432353653315f130f5f5a726d524b35435432353653315f140f5f5a6c74524b35435432353653315f150f5f5a6774524b35435432353653315f160f5f5a6571524b35435432353653315f1704696e697418056170706c7902cf011900030000010002000103000001000200020200000100030200000100040200000100050300000100020006030000010002000701000008010000090100000a02000001000b02000001000c030000010002000d030000010002000e02000001000f03000130010131020132100300013001013102013211030001300101310201321203000130010131020132130300013001013102013214020001300101311502000130010131160200013001013117010001301808000130010131020132030133040134050135060136070137";


		string lackApply = "0061736d0100000001140460037f7f7f0060027f7f017f60017f0060000002730803656e76086469765f75323536000003656e760765715f75323536000103656e760767745f75323536000103656e76076c745f75323536000103656e76086d6f645f75323536000003656e76086d756c5f75323536000003656e76087375625f75323536000003656e760574657374310002030a09000000000001010103040401700000050301000107a1010a066d656d6f727902000f5f5a706c524b35435432353653315f00080f5f5a6d69524b35435432353653315f00090f5f5a6d6c524b35435432353653315f000a0f5f5a6476524b35435432353653315f000b0f5f5a726d524b35435432353653315f000c0f5f5a6c74524b35435432353653315f000d0f5f5a6774524b35435432353653315f000e0f5f5a6571524b35435432353653315f000f04696e697400100a64090a0020012002200010060b0a0020012002200010060b0a0020012002200010050b0a0020012002200010000b0a0020012002200010040b0b002000200110034100470b0b002000200110024100470b0b002000200110014100470b0700418a3410070b0b0a010041040b0410040000";
		string gas = "0061736d01000000011d0660037f7f7f0060027f7f017f60027f7f0060017f0060000060017e0002a8010b03656e76086469765f75323536000003656e760765715f75323536000103656e760867657473746f7265000203656e760767745f75323536000103656e76076c745f75323536000103656e76086d6f645f75323536000003656e76086d756c5f75323536000003656e76097072696e7475323536000303656e760873657473746f7265000203656e760c7365747532353676616c7565000203656e76087375625f753235360000030b0a00000000000101010405040401700000050301000107a9010b066d656d6f727902000f5f5a706c524b35435432353653315f000b0f5f5a6d69524b35435432353653315f000c0f5f5a6d6c524b35435432353653315f000d0f5f5a6476524b35435432353653315f000e0f5f5a726d524b35435432353653315f000f0f5f5a6c74524b35435432353653315f00100f5f5a6774524b35435432353653315f00110f5f5a6571524b35435432353653315f001204696e69740013056170706c7900140af7020a0a00200120022000100a0b0a00200120022000100a0b0a0020012002200010060b0a0020012002200010000b0a0020012002200010050b0b002000200110044100470b0b002000200110034100470b0b002000200110014100470b02000b960203027f047e017f410041002802044180016b220736020442002104423b2103411021024200210503400240024002400240024020044209560d0020022c00002201419f7f6a41ff017141194b0d01200141a0016a21010c020b420021062004420b580d020c030b200141ea016a41002001414f6a41ff01714105491b21010b2001ad42388642388721060b2006421f83200342ffffffff0f838621060b200241016a2102200442017c2104200620058421052003427b7c2203427a520d000b024020052000520d00200741d8006a41201009200741306a41301009200741d8006a200741306a1008200741d8006a200741306a1008200741d8006a200741086a1002200741086a10070b410020074180016a3602040b0b28040041040b04400400000041100b0b746573745f66756e6333000041200b0236000041300b023700";
		string initGas_1 = "0061736d0100000001140460037f7f7f0060027f7f017f60000060017e0002670703656e76086469765f75323536000003656e760765715f75323536000103656e760767745f75323536000103656e76076c745f75323536000103656e76086d6f645f75323536000003656e76086d756c5f75323536000003656e76087375625f753235360000030b0a00000000000101010203040401700000050301000107a9010b066d656d6f727902000f5f5a706c524b35435432353653315f00070f5f5a6d69524b35435432353653315f00080f5f5a6d6c524b35435432353653315f00090f5f5a6476524b35435432353653315f000a0f5f5a726d524b35435432353653315f000b0f5f5a6c74524b35435432353653315f000c0f5f5a6774524b35435432353653315f000d0f5f5a6571524b35435432353653315f000e04696e6974000f056170706c7900100a90040a3601017f4100410028020441106b22033602042003200136020c20032002360208200328020c2002200010064100200341106a3602040b3601017f4100410028020441106b22033602042003200136020c20032002360208200328020c2002200010064100200341106a3602040b3601017f4100410028020441106b22033602042003200136020c20032002360208200328020c2002200010054100200341106a3602040b3601017f4100410028020441106b22033602042003200136020c20032002360208200328020c2002200010004100200341106a3602040b3601017f4100410028020441106b22033602042003200136020c20032002360208200328020c2002200010044100200341106a3602040b3b01017f4100410028020441106b22023602042002200036020c20022001360208200228020c2001100321014100200241106a36020420014100470b3b01017f4100410028020441106b22023602042002200036020c20022001360208200228020c2001100221014100200241106a36020420014100470b3b01017f4100410028020441106b22023602042002200036020c20022001360208200228020c2001100121014100200241106a36020420014100470b3701017f410028020441106b2200410136020c200041023602082000200028020c41026a3602042000200028020c20002802086a3602000b0f00410028020441106b20003703080b0b0a010041040b0410040000";
		string initGas_2 = "0061736d0100000001140460037f7f7f0060027f7f017f60000060017e0002670703656e76086469765f75323536000003656e760765715f75323536000103656e760767745f75323536000103656e76076c745f75323536000103656e76086d6f645f75323536000003656e76086d756c5f75323536000003656e76087375625f753235360000030b0a00000000000101010203040401700000050301000107a9010b066d656d6f727902000f5f5a706c524b35435432353653315f00070f5f5a6d69524b35435432353653315f00080f5f5a6d6c524b35435432353653315f00090f5f5a6476524b35435432353653315f000a0f5f5a726d524b35435432353653315f000b0f5f5a6c74524b35435432353653315f000c0f5f5a6774524b35435432353653315f000d0f5f5a6571524b35435432353653315f000e04696e6974000f056170706c7900100a80040a3601017f4100410028020441106b22033602042003200136020c20032002360208200328020c2002200010064100200341106a3602040b3601017f4100410028020441106b22033602042003200136020c20032002360208200328020c2002200010064100200341106a3602040b3601017f4100410028020441106b22033602042003200136020c20032002360208200328020c2002200010054100200341106a3602040b3601017f4100410028020441106b22033602042003200136020c20032002360208200328020c2002200010004100200341106a3602040b3601017f4100410028020441106b22033602042003200136020c20032002360208200328020c2002200010044100200341106a3602040b3b01017f4100410028020441106b22023602042002200036020c20022001360208200228020c2001100321014100200241106a36020420014100470b3b01017f4100410028020441106b22023602042002200036020c20022001360208200228020c2001100221014100200241106a36020420014100470b3b01017f4100410028020441106b22023602042002200036020c20022001360208200228020c2001100121014100200241106a36020420014100470b2701017f410028020441106b2200410136020c200041023602082000200028020c41026a3602040b0f00410028020441106b20003703080b0b0a010041040b0410040000";
		string initGas_3 = "0061736d0100000001140460037f7f7f0060027f7f017f60000060017e0002670703656e76086469765f75323536000003656e760765715f75323536000103656e760767745f75323536000103656e76076c745f75323536000103656e76086d6f645f75323536000003656e76086d756c5f75323536000003656e76087375625f753235360000030b0a00000000000101010203040401700000050301000107a9010b066d656d6f727902000f5f5a706c524b35435432353653315f00070f5f5a6d69524b35435432353653315f00080f5f5a6d6c524b35435432353653315f00090f5f5a6476524b35435432353653315f000a0f5f5a726d524b35435432353653315f000b0f5f5a6c74524b35435432353653315f000c0f5f5a6774524b35435432353653315f000d0f5f5a6571524b35435432353653315f000e04696e6974000f056170706c7900100afa030a3601017f4100410028020441106b22033602042003200136020c20032002360208200328020c2002200010064100200341106a3602040b3601017f4100410028020441106b22033602042003200136020c20032002360208200328020c2002200010064100200341106a3602040b3601017f4100410028020441106b22033602042003200136020c20032002360208200328020c2002200010054100200341106a3602040b3601017f4100410028020441106b22033602042003200136020c20032002360208200328020c2002200010004100200341106a3602040b3601017f4100410028020441106b22033602042003200136020c20032002360208200328020c2002200010044100200341106a3602040b3b01017f4100410028020441106b22023602042002200036020c20022001360208200228020c2001100321014100200241106a36020420014100470b3b01017f4100410028020441106b22023602042002200036020c20022001360208200228020c2001100221014100200241106a36020420014100470b3b01017f4100410028020441106b22023602042002200036020c20022001360208200228020c2001100121014100200241106a36020420014100470b02000b2e01017f410028020441206b2201200037031820014101360214200141023602102001200128021441026a36020c0b0b0a010041040b0410040000";
		string infiniteLoop = "0061736d01000000010c0360017f0060000060017e00020d0103656e76057465737431000003030201020404017000000503010001071903066d656d6f7279020004696e69740001056170706c7900020a100202000b0b000340410210000c000b0b0b0a010041040b0410400000";
		string infiniteLoop_2 = "0061736d0100000001080260000060017e0003030200010404017000000503010001071903066d656d6f7279020004696e69740000056170706c7900010a0c0202000b070003400c000b0b0b0a010041040b0410400000";
		string overflow = "0061736d0100000001170560037f7f7f0060027f7f0060017f0060000060017e0002510503656e76086164645f75323536000003656e76086469765f75323536000003656e76097072696e7475323536000203656e760c7365747532353676616c7565000103656e76087375625f75323536000003060500000003040404017000000503010001074f06066d656d6f727902000f5f5a706c524b35435432353653315f00050f5f5a6d69524b35435432353653315f00060f5f5a6476524b35435432353653315f000704696e69740008056170706c7900090a9601050a0020012002200010000b0a0020012002200010040b0a0020012002200010010b02000b7001017f4100410028020441d0016b2201360204200141a8016a4110100320014180016a41201003200141d8006a41301003200141a8016a20014180016a200141306a1004200141306a200141d8006a200141086a1000200141306a1002200141086a10024100200141d0016a3602040b0b1f040041040b04404000000041100b0230000041200b0231000041300b023200";
		string overflow_2 = "0061736d0100000001170560037f7f7f0060027f7f0060017f0060000060017e0002510503656e76086164645f75323536000003656e76086469765f75323536000003656e76097072696e7475323536000203656e760c7365747532353676616c7565000103656e76087375625f75323536000003060500000003040404017000000503010001074f06066d656d6f727902000f5f5a706c524b35435432353653315f00050f5f5a6d69524b35435432353653315f00060f5f5a6476524b35435432353653315f000704696e69740008056170706c7900090a7e050a0020012002200010000b0a0020012002200010040b0a0020012002200010010b02000b5801047f4100410028020441d0006b2204360204200441101003200441286a220141201003200441d0006a220241301003200441586a220341c0001003200410022001100220021002200310024100200441d0006a3602040b0b27050041040b04504000000041100b0230000041200b0231000041300b0232000041c0000b023300";
		string WAVMassert = "0061736d0100000001130460037f7f7f0060027f7f0060000060017e00023f0403656e760a5741564d417373657274000103656e76086164645f75323536000003656e76086469765f75323536000003656e76087375625f75323536000003060500000002030404017000000503010001074f06066d656d6f727902000f5f5a706c524b35435432353653315f00040f5f5a6d69524b35435432353653315f00050f5f5a6476524b35435432353653315f000604696e69740007056170706c7900080a34050a0020012002200010010b0a0020012002200010030b0a0020012002200010020b02000b0e004101411010004100412010000b0b34030041040b04304000000041100b10313131313131313131313131313131000041200b1030303030303030303030303030303000";
		string WAVMthrow = "0061736d0100000001130460037f7f7f0060017f017f60000060017e00024e0403656e76185f5f6378615f616c6c6f636174655f657863657074696f6e000103656e760b5f5f6378615f7468726f77000003656e76086469765f75323536000003656e76055f5a544969037f000304030002030404017000000503010001072b04066d656d6f727902000f5f5a6476524b35435432353653315f000304696e69740004056170706c7900050a28030a0020012002200010020b02000b1801017f41041000220141013602002001230041001001000b0b0a010041040b0410400000";
		string overflow_3 = "0061736d0100000001170560037f7f7f0060027f7f0060017f0060000060017e0002330303656e76086469765f75323536000003656e76097072696e7475323536000203656e760c7365747532353676616c756500010304030003040404017000000503010001072b04066d656d6f727902000f5f5a6476524b35435432353653315f000304696e69740004056170706c7900050a49030a0020012002200010000b02000b3901017f4100410028020441c0006b2201360204200141206a41101002200141201002200141206a1001200110014100200141c0006a3602040b0b20030041040b04304000000041100b063131313131000041200b06323232323200";
		string cast = "0061736d01000000010e0360037f7f7f0060000060017e00022e0303656e76086164645f75323536000003656e76086469765f75323536000003656e76087375625f75323536000003060500000001020404017000000503010001074f06066d656d6f727902000f5f5a706c524b35435432353653315f00030f5f5a6d69524b35435432353653315f00040f5f5a6476524b35435432353653315f000504696e69740006056170706c7900070ae301053601017f4100410028020441106b22033602042003200136020c20032002360208200328020c2002200010004100200341106a3602040b3601017f4100410028020441106b22033602042003200136020c20032002360208200328020c2002200010024100200341106a3602040b3601017f4100410028020441106b22033602042003200136020c20032002360208200328020c2002200010014100200341106a3602040b02000b3901017f410028020441206b22012000370318200141e3003a0017200120012c00173602102001200141176a36020c2001200141176a3602080b0b0a010041040b0410400000";
		string invalid_deleted_point = "0061736d01000000011b0660037f7f7f0060027f7f0060017f006000017f60000060017e0002330303656e76086469765f75323536000003656e76097072696e7475323536000203656e760c7365747532353676616c75650001030504000304050404017000000503010001073605066d656d6f727902000f5f5a6476524b35435432353653315f0003085f5a3474656d7076000404696e69740005056170706c7900060a77040a0020012002200010000b3201017f4100410028020441306b2200360204200041086a41101002200041086a10014100200041306a360204200041086a0b02000b3401017f4100410028020441306b2201360204200141086a41101002200141086a1001200141086a10014100200141306a3602040b0b11020041040b04204000000041100b023700";
		string newDelete = "0061736d0100000001160560017f0060017f017f60000060017e0060027f7f0002260303656e760466726565000003656e76066d616c6c6f63000103656e76067072696e74730000030807010002030104010404017000000503010001072a05066d656d6f72790200055f5a6e776a0003065f5a646c5076000404696e69740005056170706c7900060ac302073801017f4100410028020441106b22013602042001200036020c411010022001200128020c100122003602084100200141106a36020420000b3001017f4100410028020441106b22013602042001200036020c41c0001002200128020c10004100200141106a3602040b02000b4b01027f4100410028020441106b22023602042002200037030820024101100310072201360204200141fb001008024020022802042201450d002001100910040b4100200241106a3602040b2b01017f4100410028020441106b22013602042001200036020c41b00110024100200141106a36020420000b3001017f4100410028020441106b22023602042002200036020c2002200136020841a00110024100200241106a3602040b2b01017f4100410028020441106b22013602042001200036020c41f00010024100200141106a36020420000b0be001060041040b04e04000000041100b2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d6e65772d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d0a000041c0000b302d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d64656c6574652d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d0a000041f0000b2a3232323232323232323232323232323232322b2b2b2b2b2b2b2b2b2b2b2b2b2b2b2b2b2b2b2b2b2b0a000041a0010b0961626320666f6f0a000041b0010b293131313131313131313131313131313131313d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d0a00";

		string test_func1_string = "00c01eae1a4067a1";
		string test_func2_string = "00001fae1a4067a1";
		string test_func3_string = "00401fae1a4067a1";
		string test_func4_string = "00801fae1a4067a1";
		string test_func5_string = "00c01fae1a4067a1";
		
		string para1_string = "15030000";
		string para2_string = "672b0000ce560000";

		BOOST_FIXTURE_TEST_SUITE(ContractTestsSuite, TestOutputHelperFixture)
		BOOST_AUTO_TEST_CASE(ctCreateContract)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 3);
			Account& account = client.get_accounts()[0];
			Account& account2 = client.get_accounts()[1];
			Account& account3 = client.get_accounts()[2];

			string gasLimit = "0xc350";
			string gasPrice = "0x04a817c800";
			string value = "0x0";
			string data = "";

			//创建空合约
			client.sendTransaction(gasLimit, gasPrice, "", value, data, account);
			client.produce_blocks();

			u256 balance = client.balance(Address(account.address));
			BOOST_REQUIRE(balance < u256(1000000000000000000));
			u256 cost = u256(1000000000000000000) - balance;
			string s_cost = cost.str();
			cout << "s_cost: " << s_cost << endl;

			//普通创建合约
			gasLimit = "0x1f71b2";
			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			cout << "s_address: " << s_address << endl;
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + code1, account);  //Create contract.
			client.produce_blocks();

			bytes contractCode = client.code(Address(s_address));  //Get contract address.
			string s_contractCode = toHex(contractCode);
			BOOST_REQUIRE(s_contractCode.compare(code1) == 0);  //Check contract code.
			u256 balance3 = client.balance(Address(account.address));
			u256 cost_create = balance - balance3;
			string s_create = cost_create.str();
			cout << "s_create: " << s_create << endl;

			//gasPrice翻倍，创建相同的合约
			gasPrice = "0x09502f9000";  //Duplicate gasPrice.
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + code1, account);  //Create contract.
			client.produce_blocks();
			u256 balance4 = client.balance(Address(account.address));
			u256 cost_create_2 = balance3 - balance4;
			string s_create_2 = cost_create_2.str();
			cout << "s_create_2: " << s_create_2 << endl;
			BOOST_REQUIRE(cost_create_2 == (cost_create * 2));  //Check cost.

			//恢复gasPrice，创建合约时，给合约转账
			gasPrice = "0x04a817c800";  //Revert gasPrice.
			value = "0x04";  //Set endowment.
			Address m_newAddress_2 = newAddress(account);  //Contract Address.
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + code1, account);  //Create contract.
			client.produce_blocks();
			u256 balance5 = client.balance(m_newAddress_2);
			cout << "contract endowment: " << balance5.str() << endl;
			BOOST_REQUIRE(balance5 == u256(4));  //Check endowment.

			//创建合约时“to”字段有值，表示普通账户，该地址没有code，“value”字段有值。
			//创建失败，解析为合约调用，“value”的值会转给“to”地址。
			Address m_newAddress_3 = newAddress(account);  //Contract Address.
			client.sendTransaction(gasLimit, gasPrice, account2.address, value, "0x" + code1, account);  //Create contract. (Error)
			client.produce_blocks();

			u256 balance6 = client.balance(m_newAddress_3);
			cout << "contract endowment: " << balance6.str() << endl;
			BOOST_REQUIRE(balance6 == u256());  //Check endowment.

			u256 balance7 = client.balance(Address(account2.address));
			cout << "contract endowment: " << balance7.str() << endl;
			BOOST_REQUIRE(balance7 - u256(1000000000000000000) == u256(4));  //Check endowment.

			bytes contractCode_2 = client.code(m_newAddress_3);  //Get contract address.
			BOOST_REQUIRE(contractCode_2.size() == 0);
			bytes contractCode_3 = client.code(Address(account2.address));
			BOOST_REQUIRE(contractCode_3.size() == 0);

			//创建合约时“to”字段有值，表示普通账户，该地址没有code，“value”字段为零。
			//创建失败，解析为合约调用。
			value = "0x00";
			Address m_newAddress_4 = newAddress(account);  //Contract Address.
			client.sendTransaction(gasLimit, gasPrice, account3.address, value, "0x" + code1, account);  //Create contract. (Error)
			client.produce_blocks();

			u256 balance8 = client.balance(m_newAddress_4);
			cout << "contract endowment: " << balance8.str() << endl;
			BOOST_REQUIRE(balance8 == u256());  //Check endowment.
			u256 balance9 = client.balance(Address(account3.address));
			cout << "contract endowment: " << balance9.str() << endl;
			BOOST_REQUIRE(balance9 == u256(1000000000000000000));  //Check endowment.
			bytes contractCode_4 = client.code(m_newAddress_4);  //Get contract address.
			BOOST_REQUIRE(contractCode_4.size() == 0);
			bytes contractCode_5 = client.code(Address(account3.address));
			BOOST_REQUIRE(contractCode_5.size() == 0);

		}

		BOOST_AUTO_TEST_CASE(ctCodeSize)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 3);
			Account& account = client.get_accounts()[0];
			Account& account2 = client.get_accounts()[1];
			Account& account3 = client.get_accounts()[2];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";

			//创建短合约
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + code1, account);
			client.produce_blocks();

			u256 balance = client.balance(Address(account.address));
			BOOST_REQUIRE(balance < u256(1000000000000000000));
			u256 cost = u256(1000000000000000000) - balance;
			string s_cost = cost.str();
			cout << "s_cost: " << s_cost << endl;

			//创建长合约
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + code2, account2);
			client.produce_blocks();

			u256 balance2 = client.balance(Address(account2.address));
			BOOST_REQUIRE(balance2 < u256(1000000000000000000));
			u256 cost2 = u256(1000000000000000000) - balance2;
			string s_cost2 = cost2.str();
			cout << "s_cost2: " << s_cost2 << endl;

			BOOST_REQUIRE(cost < cost2);

			//调整交易的gasLimit，模拟发布合约代码过长，超过块最大gasLimit限制
			gasLimit = "0x1f71b20000";
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + code2, account2);
			client.produce_blocks();

			u256 balance3 = client.balance(Address(account2.address));
			u256 cost3 = balance2 - balance3;
			string s_cost3 = cost3.str();
			cout << "s_cost3: " << s_cost3 << endl;

			BOOST_REQUIRE(cost3  == u256());
		}

		BOOST_AUTO_TEST_CASE(ctLackBalance)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 3);
			Account& account = client.get_accounts()[0];
			Account& account2 = client.get_accounts()[1];
			Account& account3 = client.get_accounts()[2];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";

			//验证io可用
			Address m_newAddress = newAddress(account);
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + code_initIO, account);
			client.produce_blocks();

			u256 balance = client.balance(Address(account.address));
			BOOST_REQUIRE(balance < u256(1000000000000000000));
			u256 cost = u256(1000000000000000000) - balance;
			cout << "cost.str(): " << cost.str() << endl;

			u256 res1 = client.storage(m_newAddress, u256(6));  //Get contract storage.
			BOOST_REQUIRE(res1 == u256(7));
			bytes contractCode = client.code(Address(m_newAddress));  //Get contract address.
			string s_contractCode = toHex(contractCode);
			BOOST_REQUIRE(s_contractCode.compare(code_initIO) == 0);  //Check contract code.

			//运行init时，gas不足。合约发布失败，扣除所有gas。
			Address m_newAddress2 = newAddress(account);
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + code_initIO_while, account2);
			client.produce_blocks();

			u256 balance2 = client.balance(Address(account2.address));
			u256 cost2 = u256(1000000000000000000) - balance2;
			BOOST_REQUIRE(cost2 == u256(2060722) * u256(20000000000));
			BOOST_REQUIRE(cost2 > cost);
			cout << "cost2.str(): " << cost2.str() << endl;

			u256 res2 = client.storage(m_newAddress2, u256(6));  //Get contract storage.
			BOOST_REQUIRE(res2 == u256());
			bytes contractCode_2 = client.code(Address(m_newAddress2));  //Get contract code.
			BOOST_REQUIRE(contractCode_2.size() == 0);

			//增大gasPrice，使地址余额小于gas*gasPrice。合约发布失败，交易没有被执行，不扣除gas。
			gasPrice = "0x04a817c80000000000";
			Address m_newAddress3 = newAddress(account);
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + code_initIO, account3);
			client.produce_blocks();

			u256 balance3 = client.balance(Address(account3.address));
			BOOST_REQUIRE(balance3 == u256(1000000000000000000));

			u256 res3 = client.storage(m_newAddress3, u256(6));  //Get contract storage.
			BOOST_REQUIRE(res3 == u256());
			bytes contractCode_3 = client.code(Address(m_newAddress3));  //Get contract code.
			BOOST_REQUIRE(contractCode_3.size() == 0);

		}

		BOOST_AUTO_TEST_CASE(ctCompile)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 3);
			Account& account = client.get_accounts()[0];
			Account& account2 = client.get_accounts()[1];
			Account& account3 = client.get_accounts()[2];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";

			//创建非法合约
			Address m_newAddress = newAddress(account);
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + code1.substr(0, 100), account);
			client.produce_blocks();

			u256 balance = client.balance(Address(account.address));
			u256 cost = u256(1000000000000000000) - balance;
			cout << "cost.str(): " << cost.str() << endl;
			BOOST_REQUIRE(cost == u256(2060722) * u256(20000000000));
			bytes contractCode_2 = client.code(Address(m_newAddress));  //Get contract code.
			BOOST_REQUIRE(contractCode_2.size() == 0);
		}

		BOOST_AUTO_TEST_CASE(ctLackField)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 3);
			Account& account = client.get_accounts()[0];
			Account& account2 = client.get_accounts()[1];
			Account& account3 = client.get_accounts()[2];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";

			//创建短合约，缺少“to”字段
			Address m_newAddress = newAddress(account);
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + code1, account);
			client.produce_blocks();

			u256 balance = client.balance(Address(account.address));
			BOOST_REQUIRE(balance < u256(1000000000000000000));
			u256 cost = u256(1000000000000000000) - balance;
			cout << "cost.str(): " << cost.str() << endl;

			bytes contractCode = client.code(Address(m_newAddress));  //Get contract address.
			string s_contractCode = toHex(contractCode);
			BOOST_REQUIRE(s_contractCode.compare(code1) == 0);

			//创建短合约，缺少“gasLimit”字段
			Address m_newAddress_2 = newAddress(account);
			client.sendTransaction("", gasPrice, "", value, "0x" + code1, account);
			client.produce_blocks();

			u256 balance2 = client.balance(Address(account.address));
			BOOST_REQUIRE(balance == balance2);

			bytes contractCode_2 = client.code(Address(m_newAddress_2));  //Get contract address.
			BOOST_REQUIRE(contractCode_2.size() == 0);

			////创建短合约，缺少“gasPrice”字段
			//Address m_newAddress_3 = newAddress(account2);
			//TransactionSkeleton ts;
			//ts.type = TransactionType::ContractCreation;
			//ts.nonce = u256(account2.nonce);
			//account2.nonce++;
			//ts.value = u256(0);
			//ts.to = Address(0);
			//ts.gasPrice = u256(0);
			//ts.gas = u256(2060722);
			//ts.data = fromHex(code1);
			//ts.from = Address(account2.address);
			//Secret secret(account2.secret);
			//client.sendTransaction(ts, secret);

			//client.produce_blocks();

			//u256 balance3 = client.balance(Address(account2.address));
			//u256 cost_2 = u256(1000000000000000000) - balance3;
			//string ss = cost_2.str();

			//bytes contractCode_3 = client.code(Address(m_newAddress_3));  //Get contract address.
			//BOOST_REQUIRE(contractCode_3.size() == 0);
		}

		BOOST_AUTO_TEST_CASE(ctInit)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 3);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";

			//创建合约，合约中没有init函数
			Address m_newAddress = newAddress(account);
			string s_address = m_newAddress.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + no_init, account);
			client.produce_blocks();

			u256 balance = client.balance(Address(account.address));
			BOOST_REQUIRE(balance < u256(1000000000000000000));
			u256 cost = u256(1000000000000000000) - balance;
			BOOST_REQUIRE(cost < u256(2060722) * u256(20000000000));
			cout << "cost.str(): " << cost.str() << endl;

			bytes contractCode = client.code(Address(m_newAddress));  //Get contract address.
			string s_contractCode = toHex(contractCode);
			BOOST_REQUIRE(s_contractCode.compare(no_init) == 0);

			//调用刚创建的，无init函数的合约
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func1_string + para1_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance2 = client.balance(Address(account.address));
			u256 cost_call = balance - balance2;
			BOOST_REQUIRE(cost_call < u256(2060722) * u256(20000000000));
			cout << "cost_call.str(): " << cost_call.str() << endl;

		}

		BOOST_AUTO_TEST_CASE(ctDiv0)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";


			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + div_0_u256, account);  //Create contract.
			client.produce_blocks();
			u256 balance1 = client.balance(Address(account.address));

			//u256除0
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func1_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance2 = client.balance(Address(account.address));
			u256 cost_call = balance1 - balance2;
			BOOST_REQUIRE(cost_call == u256(2060722) * u256(20000000000));


			Address m_newAddress2 = newAddress(account);  //Contract Address.
			string s_address2 = m_newAddress2.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + div_0_i32, account);  //Create contract.
			client.produce_blocks();
			u256 balance3 = client.balance(Address(account.address));

			//i32除0
			client.sendTransaction(gasLimit, gasPrice, s_address2, value, test_func1_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance4 = client.balance(Address(account.address));
			u256 cost_call2 = balance3 - balance4;
			BOOST_REQUIRE(cost_call2 == u256(2060722) * u256(20000000000));
		}

		BOOST_AUTO_TEST_CASE(ctInvalidU256Print)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";


			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + invalid_u256_print, account);  //Create contract.
			client.produce_blocks();
			u256 balance1 = client.balance(Address(account.address));

			bytes contractCode = client.code(Address(m_newAddress));  //Get contract address.
			string s_contractCode = toHex(contractCode);
			BOOST_REQUIRE(s_contractCode.compare(invalid_u256_print) == 0);

			//输出错误的u256  accessDestroy2.cpp
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func1_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance2 = client.balance(Address(account.address));
			u256 cost_call = balance1 - balance2;
			BOOST_REQUIRE(cost_call == u256(2060722) * u256(20000000000));
		}

		BOOST_AUTO_TEST_CASE(ctInfiniteLoop)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";


			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + infiniteLoop, account);  //Create contract.
			client.produce_blocks();
			u256 balance1 = client.balance(Address(account.address));

			bytes contractCode = client.code(Address(m_newAddress));  //Get contract address.
			string s_contractCode = toHex(contractCode);
			BOOST_REQUIRE(s_contractCode.compare(infiniteLoop) == 0);

			//无限循环调用注册函数  infiniteLoop.cpp
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func1_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance2 = client.balance(Address(account.address));
			u256 cost_call = balance1 - balance2;
			BOOST_REQUIRE(cost_call == u256(2060722) * u256(20000000000));
		}

		BOOST_AUTO_TEST_CASE(ctInfiniteLoop2)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";

			//无限循环调用"1+1"  infiniteLoop_2.cpp
			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + infiniteLoop_2, account);  //Create contract.
			client.produce_blocks();
			u256 balance1 = client.balance(Address(account.address));
			BOOST_REQUIRE(u256(1000000000000000000) - balance1 == u256(2060722) * u256(20000000000));

			bytes contractCode = client.code(Address(m_newAddress));  //Get contract address.
			BOOST_REQUIRE(contractCode.size() == 0);
		}

		BOOST_AUTO_TEST_CASE(ctOverflow)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";


			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + overflow, account);  //Create contract.
			client.produce_blocks();
			u256 balance1 = client.balance(Address(account.address));

			bytes contractCode = client.code(Address(m_newAddress));  //Get contract address.
			string s_contractCode = toHex(contractCode);
			BOOST_REQUIRE(s_contractCode.compare(overflow) == 0);

			//u256加减法越界  overflow.cpp
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func1_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance2 = client.balance(Address(account.address));
			u256 cost_call = balance1 - balance2;
			BOOST_REQUIRE(cost_call < u256(2060722) * u256(20000000000));
		}

		BOOST_AUTO_TEST_CASE(ctOverflow2)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";


			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + overflow_2, account);  //Create contract.
			client.produce_blocks();
			u256 balance1 = client.balance(Address(account.address));

			bytes contractCode = client.code(Address(m_newAddress));  //Get contract address.
			string s_contractCode = toHex(contractCode);
			BOOST_REQUIRE(s_contractCode.compare(overflow_2) == 0);

			//数组下标越界  overflow2.cpp
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func1_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance2 = client.balance(Address(account.address));
			u256 cost_call = balance1 - balance2;
			BOOST_REQUIRE(cost_call < u256(2060722) * u256(20000000000));
		}

		BOOST_AUTO_TEST_CASE(ctAssert)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";


			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + WAVMassert, account);  //Create contract.
			client.produce_blocks();
			u256 balance1 = client.balance(Address(account.address));

			bytes contractCode = client.code(Address(m_newAddress));  //Get contract address.
			string s_contractCode = toHex(contractCode);
			BOOST_REQUIRE(s_contractCode.compare(WAVMassert) == 0);

			//测试脚本中调用注册函数WAVMAssert  assert.cpp
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func1_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance2 = client.balance(Address(account.address));
			u256 cost_call = balance1 - balance2;
			BOOST_REQUIRE(cost_call == u256(2060722) * u256(20000000000));
		}

		BOOST_AUTO_TEST_CASE(ctThrow)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";


			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + WAVMthrow, account);  //Create contract.
			client.produce_blocks();
			u256 balance1 = client.balance(Address(account.address));

			bytes contractCode = client.code(Address(m_newAddress));  //Get contract address.
			BOOST_REQUIRE(contractCode.size() == 0);
			//测试脚本使用throw  throw.cpp
		}

		BOOST_AUTO_TEST_CASE(ctOverflow3)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";


			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + overflow_3, account);  //Create contract.
			client.produce_blocks();
			u256 balance1 = client.balance(Address(account.address));

			bytes contractCode = client.code(Address(m_newAddress));  //Get contract address.
			string s_contractCode = toHex(contractCode);
			BOOST_REQUIRE(s_contractCode.compare(overflow_3) == 0);

			//脚本中定义u256为8个int，应该为10个int  overflow3.cpp
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func1_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance2 = client.balance(Address(account.address));
			u256 cost_call = balance1 - balance2;
			BOOST_REQUIRE(cost_call < u256(2060722) * u256(20000000000));
		}

		BOOST_AUTO_TEST_CASE(ctCast)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";


			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + cast, account);  //Create contract.
			client.produce_blocks();
			u256 balance1 = client.balance(Address(account.address));

			bytes contractCode = client.code(Address(m_newAddress));  //Get contract address.
			string s_contractCode = toHex(contractCode);
			BOOST_REQUIRE(s_contractCode.compare(cast) == 0);

			//强制类型转换  cast.cpp
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func1_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance2 = client.balance(Address(account.address));
			u256 cost_call = balance1 - balance2;
			BOOST_REQUIRE(cost_call < u256(2060722) * u256(20000000000));
		}

		BOOST_AUTO_TEST_CASE(ctInvalidDeletedPoint)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";


			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + invalid_deleted_point, account);  //Create contract.
			client.produce_blocks();
			u256 balance1 = client.balance(Address(account.address));

			bytes contractCode = client.code(Address(m_newAddress));  //Get contract address.
			string s_contractCode = toHex(contractCode);
			BOOST_REQUIRE(s_contractCode.compare(invalid_deleted_point) == 0);

			//访问调用函数返回的局部变量  accessDestroy.cpp
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func1_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance2 = client.balance(Address(account.address));
			u256 cost_call = balance1 - balance2;
			BOOST_REQUIRE(cost_call < u256(2060722) * u256(20000000000));
		}

		BOOST_AUTO_TEST_CASE(ctNewDelete)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";


			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + newDelete, account);  //Create contract.
			client.produce_blocks();
			u256 balance1 = client.balance(Address(account.address));

			bytes contractCode = client.code(Address(m_newAddress));  //Get contract address.
			string s_contractCode = toHex(contractCode);
			BOOST_REQUIRE(s_contractCode.compare(newDelete) == 0);

			//new、delete函数，调用到相应的类构造与析构函数  newDelete_2.cpp
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func1_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance2 = client.balance(Address(account.address));
			u256 cost_call = balance1 - balance2;
			BOOST_REQUIRE(cost_call < u256(2060722) * u256(20000000000));
		}

		BOOST_AUTO_TEST_CASE(ctUnknowInstruction)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";

			//调用未知函数 unknowInstruction.cpp
			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + unknowInstruction, account);  //Create contract.
			client.produce_blocks();
			u256 balance1 = client.balance(Address(account.address));

			bytes contractCode = client.code(Address(m_newAddress));  //Get contract address.
			BOOST_REQUIRE(contractCode.size() == 0);
			BOOST_REQUIRE(u256(1000000000000000000) - balance1 == u256(2060722) * u256(20000000000));
		}

		BOOST_AUTO_TEST_CASE(ctMemoryRef)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";


			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + memoryRef, account);  //Create contract.
			client.produce_blocks();
			u256 balance1 = client.balance(Address(account.address));

			//memoryRef传入负值 memoryRef.cpp
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func1_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance2 = client.balance(Address(account.address));
			u256 cost_call = balance1 - balance2;
			BOOST_REQUIRE(cost_call == u256(2060722) * u256(20000000000));
		}

		BOOST_AUTO_TEST_CASE(ctTransferBalance)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";


			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + transferBalance, account);  //Create contract.
			client.produce_blocks();
			u256 balance1 = client.balance(Address(account.address));

			//合约内部转账，余额不足
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func1_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance2 = client.balance(Address(account.address));
			u256 cost_call = balance1 - balance2;
			
			BOOST_REQUIRE(cost_call == u256(2060722) * u256(20000000000));

			u256 balance3 = client.balance(Address("0x0000000000000000000000000000000000011111"));
			BOOST_REQUIRE(balance3 == u256(0));

			//向合约地址转账
			client.sendTransaction(gasLimit, gasPrice, s_address, "99999", test_func3_string, account);
			client.produce_blocks();
			u256 balance4 = client.balance(Address(s_address));
			cout << "balance4.str(): " << balance4.str() << endl;
			BOOST_REQUIRE(balance4 == u256(99999));

			//合约内部转账，余额足够
			u256 balance5 = client.balance(Address(account.address));
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func1_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance6 = client.balance(Address(account.address));
			u256 cost_call2 = balance5 - balance6;
			BOOST_REQUIRE(cost_call2 < u256(2060722) * u256(20000000000));

			u256 balance7 = client.balance(Address("0x0000000000000000000000000000000000011111"));
			cout << "balance7.str(): " << balance7.str() << endl;
			u256 balance8 = client.balance(Address("0000000000000000000000000000000000002b67"));
			cout << "balance8.str(): " << balance8.str() << endl;
			u256 balance9 = client.balance(Address(s_address));
			cout << "balance9.str(): " << balance9.str() << endl;

			BOOST_REQUIRE(balance7 == u256(123));
		}

		BOOST_AUTO_TEST_CASE(ctTransferBalance2)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";


			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + transferBalance, account);  //Create contract.
			client.produce_blocks();

			Address m_newAddress_2 = newAddress(account);  //Contract Address2.
			string s_address_2 = m_newAddress_2.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + code1, account);
			client.produce_blocks();

			//合约内部转账，余额不足
			u256 balance1 = client.balance(Address(account.address));
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func2_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance2 = client.balance(Address(account.address));
			u256 cost_call = balance1 - balance2;
			BOOST_REQUIRE(cost_call < u256(2060722) * u256(20000000000));

			u256 balance3 = client.balance(m_newAddress_2);
			BOOST_REQUIRE(balance3 == u256(0));

			//向合约地址转账
			client.sendTransaction(gasLimit, gasPrice, s_address, "99999", test_func3_string, account);
			client.produce_blocks();
			u256 balance4 = client.balance(Address(s_address));
			cout << "balance4.str(): " << balance4.str() << endl;
			BOOST_REQUIRE(balance4 == u256(99999));

			//合约内部转账，余额足够
			u256 balance5 = client.balance(Address(account.address));
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func2_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance6 = client.balance(Address(account.address));
			u256 cost_call2 = balance5 - balance6;
			BOOST_REQUIRE(cost_call2 < u256(2060722) * u256(20000000000));

			u256 balance7 = client.balance(m_newAddress_2);
			cout << "balance7.str(): " << balance7.str() << endl;
			BOOST_REQUIRE(balance7 == u256(456));
		}

		BOOST_AUTO_TEST_CASE(ctLackApply)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";

			//部署缺少apply函数的合约
			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + lackApply, account);  //Create contract.
			client.produce_blocks();
			u256 balance1 = client.balance(Address(account.address));
			u256 cost_call2 = u256(1000000000000000000) - balance1;
			BOOST_REQUIRE(cost_call2 < u256(2060722) * u256(20000000000));

			bytes contractCode = client.code(Address(s_address));  //Get contract address.
			string s_contractCode = toHex(contractCode);
			BOOST_REQUIRE(s_contractCode.compare(lackApply) == 0);  //Check contract code.

			
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func1_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance2 = client.balance(Address(account.address));
			u256 cost_call3 = balance1 - balance2;
			BOOST_REQUIRE(cost_call3 == u256(2060722) * u256(20000000000));
		}

		BOOST_AUTO_TEST_CASE(ctGas)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";


			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			cout << "s_address: " << s_address << endl;
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + gas, account);  //Create contract.
			client.produce_blocks();
			u256 balance1 = client.balance(Address(account.address));

			//调用合约方法1 加
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func1_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance2 = client.balance(Address(account.address));
			u256 cost_call = balance1 - balance2;
			BOOST_REQUIRE(cost_call == u256(502320000000000));
			//cout << "cost_call.str(): " << cost_call.str() << endl;

			//调用合约方法2 减
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func2_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance3 = client.balance(Address(account.address));
			u256 cost_call_2 = balance2 - balance3;
			BOOST_REQUIRE(cost_call_2 == u256(501040000000000));
			//cout << "cost_call_2.str(): " << cost_call_2.str() << endl;

			
			//调用合约方法3 IO
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func3_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance4 = client.balance(Address(account.address));
			u256 cost_call_3 = balance3 - balance4;
			BOOST_REQUIRE(cost_call_3 == u256(1010080000000000));
			//cout << "cost_call_3.str(): " << cost_call_3.str() << endl;
		}

		BOOST_AUTO_TEST_CASE(ctInitGas)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";

			//创建合约1，init执行了两次加法，apply什么也没做
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + initGas_1, account);  //Create contract.
			client.produce_blocks();
			u256 balance1 = client.balance(Address(account.address));
			u256 cost_call = u256(1000000000000000000) - balance1;

			//创建合约1，init执行了一次加法，apply什么也没做
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + initGas_2, account);  //Create contract.
			client.produce_blocks();
			u256 balance2 = client.balance(Address(account.address));
			u256 cost_call2 = balance1 - balance2;

			//创建合约1，init什么也没做，apply执行了一次加法
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + initGas_3, account);  //Create contract.
			client.produce_blocks();
			u256 balance3 = client.balance(Address(account.address));
			u256 cost_call3 = balance2 - balance3;

			BOOST_REQUIRE(cost_call > cost_call2);
			BOOST_REQUIRE(cost_call2 > cost_call3);
		}

		BOOST_AUTO_TEST_CASE(ctCallContract)
		{
			DposTestClient client;

			BOOST_REQUIRE(client.get_accounts().size() >= 2);
			Account& account = client.get_accounts()[0];

			string gasLimit = "0x1f71b2";
			string gasPrice = "0x04a817c800";
			string value = "0x0";


			Address m_newAddress = newAddress(account);  //Contract Address.
			string s_address = m_newAddress.hex();
			cout << "s_address: " << s_address << endl;
			client.sendTransaction(gasLimit, gasPrice, "", value, "0x" + code1, account);  //Create contract.
			client.produce_blocks();

			u256 balance3 = client.balance(Address(account.address));
			bytes contractCode = client.code(Address(s_address));  //Get contract address.
			string s_contractCode = toHex(contractCode);
			BOOST_REQUIRE(s_contractCode.compare(code1) == 0);  //Check contract code.

			//调用合约方法1
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func1_string + para1_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance4 = client.balance(Address(account.address));
			u256 cost_call = balance3 - balance4;
			BOOST_REQUIRE(cost_call < u256(2060722) * u256(20000000000));
			string s_call = cost_call.str();
			cout << "s_call: " << s_call << endl;

			//调用合约方法2
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func2_string + para2_string, account);  //Call contract code.
			client.produce_blocks();

			u256 balance5 = client.balance(Address(account.address));
			u256 cost_call_2 = balance4 - balance5;
			BOOST_REQUIRE(cost_call_2 < u256(2060722) * u256(20000000000));
			string s_call_2 = cost_call_2.str();
			cout << "s_call_2: " << s_call_2 << endl;

			//调用函数散列值太短
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func2_string.substr(0, 14), account);  //Call contract code. (Error)
			client.produce_blocks();

			u256 balance6 = client.balance(Address(account.address));
			u256 cost_call_3 = balance5 - balance6;
			BOOST_REQUIRE(cost_call_3 == u256(2060722) * u256(20000000000));

			//调用函数参数不对
			client.sendTransaction(gasLimit, gasPrice, s_address, value, test_func2_string + para1_string, account);  //Call contract code. (Error)
			client.produce_blocks();

			u256 balance7 = client.balance(Address(account.address));
			u256 cost_call_4 = balance6 - balance7;
			BOOST_REQUIRE(cost_call_4 == u256(2060722) * u256(20000000000));

		}

		BOOST_AUTO_TEST_SUITE_END()

	}
}